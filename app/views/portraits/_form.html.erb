<%# portraits/_form.html.erb %>

<%= simple_form_for @portrait, html: {multipart: true} do |f| %>
  <%= f.error_notification %>

  <%# dispatching the form fields in variables to pass them to the partial %>
  <% title = f.input :title, label: false %>
  <% teaser = f.cktext_area :teaser, rows: 10, :ckeditor => {language: I18n.locale} %>
  <% body = f.cktext_area :body, rows: 50, :ckeditor => {language: I18n.locale} %>
  <% status = f.input :status,
    collection: %w(draft published featured archived),
    as: :radio_buttons,
    prompt: "Please select a status for this portrait",
    selected: "draft",
    label: 'Please select a status for this portrait',
    hint: 'If you select draft or archived, the portrait will not be published on the website',
    error: 'Assigning a status to a portrait is mandatory, please specify one'
  %>
  <% submit_button = f.button :submit, 'Save your changes!!!', class: 'my-submit-button btn btn-primary btn-lg btn-block' %>

  <% provide :picture do %>
    <div class="row contenu illustration">
      <div class="col-xs-12 col-sm-10 col-sm-offset-1 col-lg-8 col-lg-offset-2">
        <%= image_tag(@portrait.media_container.media(:for_slider), alt: @portrait.media_container.title) %>
        <div class="form-group">
          <%= text_field_tag("portrait[picture_title]", @portrait.media_container.title, id:"portrait_picture_title", class: "form-control") %>
        </div>
        <p>
          <%= t :portrait_file_upload_back_office_legend, default: "If you want to change your picture, please upload a file here:" %>
        </p>
          <%= render partial: 'shared/aktion_article_portrait/additional_picture_form.html.erb',
              locals: {
                file_field_name: "portrait[new_md][file]",
                file_field_id: "portrait_new_md_file",
                title_field_name: "portrait[new_md][title]",
                title_field_id: "portrait_new_md_title"
              }
          %>

        <style>
          .my-row-wrapper-label {
            display: block;
            cursor: pointer;
            font-weight: normal;
          }
          .flex-row {
            display: flex;
            flex-direction: row;
          }
          .flex-col-11 {
            flex-grow: 11;
          }
          .flex-col-1 {
            flex-grow: 1;
          }
          .flex-bottom-aligned-content {
            align-self: flex-end;
          }
        </style>

        <label for=<%= "change_picture_everywhere_yes"%> class="my-row-wrapper-label" >
          <div class="row flex-row">
            <div class="col-xs-11 flex-col-11">
                <%= t(:portrait_change_this_picture_every_where_html, default: "Do you want this picture to be changed everywhere it appears in the website (i.e. as illustration of other contents such as articles, actions or other portraits)?") %>
            </div>
            <div class="col-xs-1 text-right flex-col-1 flex-bottom-aligned-content">
              <input class="radio_buttons required"  type="radio" name=<%="portrait[new_md][change_everywhere]"%> id=<%="change_picture_everywhere_yes"%> value='true'>
            </div>
          </div>
        </label>

        <label for=<%= "change_picture_everywhere_no"%> class="my-row-wrapper-label" >
          <div class="row flex-row">
            <div class="col-xs-11 flex-col-11">
                <%= t :portrait_change_this_picture_only_here_html, default: "Or do you want this picture to be changed only on this portrait (including where this portrait appears on index pages or as a link at the bottom of articles, actions or other portraits)?" %>
            </div>
            <div class="col-xs-1 text-right flex-col-1 flex-bottom-aligned-content">
              <input class="radio_buttons required"  type="radio" name=<%="portrait[new_md][change_everywhere]"%> id=<%="change_picture_everywhere_no"%> value='false'>
            </div>
          </div>
        </label>

        <hr>
      </div>
    </div>
  <% end %>

  <%# building a form to allow user to change the categories applying to the aktion, select the main category and add new categories %>
  <% provide :categories_form do %>
    <%= render partial: 'shared/aktion_article_portrait/categories_form',
      locals: {
        chosen_category_ids: @portrait.categorizings.map(&:category_id),
        item: 'portrait',
        item_i18n_name: t(:item_portrait_for_check_box_label, default: 'this portrait')
      }
    %>
  <% end %>

  <%# render the partial with the variables passed in an object %>
  <%= render partial: 'portraits/partials/container',
    object: @portrait, locals: {
      parameters: {
        title: title,
        teaser: teaser,
        body: body,
        status: status,
        submit_button: submit_button
      }
    }
  %>

<% end %>
